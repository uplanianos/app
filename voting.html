<!DOCTYPE html>
<meta charset="utf-8">
<html lang="en-US">
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="media/uplanianos-icon.png">
	<link rel="stylesheet" href="files/pages-style.css">
	<title>Uplanianos - Votaci√≥n Uplaniana</title>
</head>

<body>
<a href="index.html"><div id="return" class="return">&larrhk;</div></a>


<div class="main" style="background-color: transparent; left-margin: 200px;">
    <div class="labels"><p>
      <select class="titleMenu" id="titleMenu" name="titleMenu" >
      <option value="0" selected disabled="disabled">‚ò∞</option>
      <option value="1">üìñ Agenda</option>
      <option value="2">‚úîÔ∏è Asistencia</option>
      <option value="3">üìÅ Avance Curricular</option>
      <option value="4">üóìÔ∏è Calendario Oficial</option>
      <option value="5">‚è≤Ô∏è Cuenta Regresiva</option>
      <option value="6">üìà Escala de Notas</option>
      <option value="7">üìö Horario de Clases</option>
      <option value="8">üíä Justificador</option>
      <option value="9">üìú Manual Estudiante</option>
      <option value="10">‚úçÔ∏è Nota de Pruebas</option>
      <option value="11">üö´ Paro Tracker</option>
      <option value="12">üíØ Promedio Integral</option>
      <option value="125">üß† Preguntas Estudio</option>
      <option value="13">üìã Simulador Examen</option>
      <option value="14">‚è≥ Temporizador</option>
      <option value="15">üìù Timebox (Upla)</option>
<!-- DISABLED     <option value="16">üìä Uplad√≠sticas</option> -->
    </select>
    <a href="index.html" style="text-decoration: none;"><b>Uplanianos App:</b></a> Votaci√≥n Uplaniana.</p></div>

<script type="text/javascript">
document.getElementById('titleMenu').addEventListener('change', function() {
 if (titleMenu.value == 1) {blurMenu(); window.location = "agenda.html"}
 if (titleMenu.value == 2) {blurMenu(); window.location = "asistencia.html?tipo=2&clases=12&asiste=0"}
 if (titleMenu.value == 3) {blurMenu(); window.location = "avance.html"}
 if (titleMenu.value == 4) {blurMenu(); window.location = "calendario.html"}
 if (titleMenu.value == 5) {blurMenu(); window.location = "countdown.html"}
 if (titleMenu.value == 6) {blurMenu(); window.location = "notas.html?escala=70"}
 if (titleMenu.value == 7) {blurMenu(); window.location = "horario.html"}
 if (titleMenu.value == 8) {blurMenu(); window.location = "justify.html"}
 if (titleMenu.value == 9) {blurMenu(); window.location = "manual-estudiante.html"}
 if (titleMenu.value == 10) {blurMenu(); window.location = "pruebas.html?total=100&puntos=0"}
 if (titleMenu.value == 11) {blurMenu(); window.location = "sigueparo.html"}
 if (titleMenu.value == 12) {blurMenu(); window.location = "integrales.html?x=2&g1=0.0&g2=0.0"}
 if (titleMenu.value == 125) {blurMenu(); window.location = "estudio.html"}
 if (titleMenu.value == 13) {blurMenu(); window.location = "examen.html?promedio=3.5&examen=4.0"}
 if (titleMenu.value == 14) {blurMenu(); window.location = "temporizador.html"}
 if (titleMenu.value == 15) {blurMenu(); window.location = "timebox.html"}
 if (titleMenu.value == 16) {blurMenu(); window.location = "upladisticas.html"}
});

function blurMenu(){document.getElementById('titleMenu').value = 0; document.getElementById('titleMenu').blur();}
</script> 


<div class="grid-item-slider" style="padding: 12px;">

<br>

<div>
 <b>Propuestas:</b>
 <input type="button" id="moreButton" value="+" onclick="doMore(); saveData()">
 <input type="button" id="lessButton" value="x" onclick="doLess(); saveData()">
 <input type="number" id="howMany" value="2" min="2" max="5" step="1" style="display: none;">
</div>

<br>

 <!- GRID ->
 <!- GRID ->
 <!- GRID ->
 <div class="grid-voting">

  <div id="divMotion1" style="grid-area: divMotion1;">1
   <input type="text"	id="motion1"	class="voteMotion" value="" placeholder="Moci√≥n N¬∞1" onchange="getValues(); savaData()" onblur="saveData()">
   <input type="number"	id="counts1"	class="votesCount" value="0" min="0" step="1" onchange="savaData()">
   <input type="button"	id="vote1More"	class="votesPlus" value="‚ûï" tabindex="-1" onclick="vote1More(); saveData()">
   <input type="button"	id="vote1Less"	class="votesLess" value="‚ûñ" tabindex="-1" onclick="vote1Less(); saveData()">
  </div>

  <div id="divMotion2" style="grid-area: divMotion2; display: none;">2
   <input type="text"	id="motion2"	class="voteMotion" value="" placeholder="Moci√≥n N¬∞2" onchange="getValues(); savaData()" onblur="saveData()">
   <input type="number"	id="counts2"	class="votesCount" value="0" min="0" step="1" readonly onchange="savaData()">
   <input type="button"	id="vote2More"	class="votesPlus" value="‚ûï" tabindex="-1" onclick="vote2More(); saveData()">
   <input type="button"	id="vote2Less"	class="votesLess" value="‚ûñ" tabindex="-1" onclick="vote2Less(); saveData()">
  </div>

  <div id="divMotion3" style="grid-area: divMotion3; display: none;">3
   <input type="text"	id="motion3"	class="voteMotion" value="" placeholder="Moci√≥n N¬∞3" onchange="getValues(); savaData()" onblur="saveData()">
   <input type="number"	id="counts3"	class="votesCount" value="0" min="0" step="1" readonly onchange="savaData()">
   <input type="button"	id="vote3More"	class="votesPlus" value="‚ûï" tabindex="-1" onclick="vote3More(); saveData()">
   <input type="button"	id="vote3Less"	class="votesLess" value="‚ûñ" tabindex="-1" onclick="vote3Less(); saveData()">
  </div>

  <div id="divMotion4" style="grid-area: divMotion4; display: none;">4
   <input type="text"	id="motion4"	class="voteMotion" value="" placeholder="Moci√≥n N¬∞4" onchange="getValues(); savaData()" onblur="saveData()">
   <input type="number"	id="counts4"	class="votesCount" value="0" min="0" step="1" readonly onchange="savaData()">
   <input type="button"	id="vote4More"	class="votesPlus" value="‚ûï" tabindex="-1" onclick="vote4More(); saveData()">
   <input type="button"	id="vote4Less"	class="votesLess" value="‚ûñ" tabindex="-1" onclick="vote4Less(); saveData()">
  </div>

  <div id="divMotion5" style="grid-area: divMotion5; display: none;">5
   <input type="text"	id="motion5"	class="voteMotion" value="" placeholder="Moci√≥n N¬∞5" onchange="getValues(); savaData()" onblur="saveData()">
   <input type="number"	id="counts5"	class="votesCount" value="0" min="0" step="1" readonly onchange="savaData()">
   <input type="button"	id="vote5More"	class="votesPlus" value="‚ûï" tabindex="-1" onclick="vote5More(); saveData()">
   <input type="button"	id="vote5Less"	class="votesLess" value="‚ûñ" tabindex="-1" onclick="vote5Less(); saveData()">
  </div>

  <div class="divTotalVotes" style="grid-area: divTotal;">Total:
   <input type="number"	id="totalVotes"	class="votesCount" value="0" min="0" step="1" style="margin: 6px;" readonly>
  </div>

  <div style="grid-area: divDelete; text-align: right;">
   <input type="button"	id="resetJunaeb" value="Borrar" onclick="clearButton()" style="width: 80px;">
  </div>


 </div><!- End of "GRID Div ->
 <!- END OF GRID ->
 <!- END OF GRID ->
 <!- END OF GRID ->

<br>

<div><big><b>Resultado:</b></big></div><br>
 <div class="voteResult">

  <div id="voteSummary" class="voteSummary"><b><u>PROPUESTAS / VOTOS:</u></b><br>
   <span id="motion1Span" style="color: blue;	display: none;">N¬∞1: 0 votos (0%).</span>
   <span id="motion2Span" style="color: red;	display: none;">N¬∞2: 0 votos (0%).</span>
   <span id="motion3Span" style="color: orange;	display: none;">N¬∞3: 0 votos (0%).</span>
   <span id="motion4Span" style="color: green;	display: none;">N¬∞4: 0 votos (0%).</span>
   <span id="motion5Span" style="color: purple;	display: none;">N¬∞5: 0 votos (0%).</span>
   <span id="motionTotal" style="color: black;	display: none;">Total: 0 Votos.</span>
  </div>

 <canvas id="myCanvas" class="myCanvas" width="232" height="232"></canvas>

</div>	<!- End of "Votes Result" Div ->

<div id="shareButton" class="voteShareButton" style="display: none;" onclick="shareLink()">¬øCOMPARTIR?</div>

<br>

</div><!- End of "Main" Div ->

<br>


<script type="text/javascript">
// SETTING UP GLOBAL VALUES!
// DECLARING ELEMENTS!

// DIVS
var divMotion1 = document.getElementById("divMotion1")
var divMotion2 = document.getElementById("divMotion2")
var divMotion3 = document.getElementById("divMotion3")
var divMotion4 = document.getElementById("divMotion4")
var divMotion5 = document.getElementById("divMotion5")

// PROPOSAL NAMES
var motion1 = document.getElementById("motion1")
var motion2 = document.getElementById("motion2")
var motion3 = document.getElementById("motion3")
var motion4 = document.getElementById("motion4")
var motion5 = document.getElementById("motion5")

// VOTING VALUES
var howMany = document.getElementById("howMany")
var counts1 = document.getElementById("counts1")
var counts2 = document.getElementById("counts2")
var counts3 = document.getElementById("counts3")
var counts4 = document.getElementById("counts4")
var counts5 = document.getElementById("counts5")
var totalVotes = document.getElementById("totalVotes")

// INITIAL SETUP FUNCTION!
function initialSetup() {

// BUTTONS & AMOUNT OF PROPOSALS!
var moreButton = document.getElementById("moreButton")
var lessButton = document.getElementById("lessButton")

if (howMany.value == 1) { document.getElementById("howMany").value = "2"; }

if (howMany.value == 2) {
 divMotion2.style.display = "block"; divMotion3.style.display = "none";
 divMotion4.style.display = "none"; divMotion5.style.display = "none";
 lessButton.style.visibility = "hidden"; moreButton.style.visibility = "visible"; }

if (howMany.value == 3) {
 divMotion2.style.display = "block"; divMotion3.style.display = "block"
 divMotion4.style.display = "none"; divMotion5.style.display = "none";
 lessButton.style.visibility = "visible"; moreButton.style.visibility = "visible"; }

if (howMany.value == 4) {
 divMotion2.style.display = "block"; divMotion3.style.display = "block";
 divMotion4.style.display = "block"; divMotion5.style.display = "none";
 lessButton.style.visibility = "visible"; moreButton.style.visibility = "visible"; }

if (howMany.value == 5) {
 divMotion2.style.display = "block"; divMotion3.style.display = "block";
 divMotion4.style.display = "block"; divMotion5.style.display = "block";
 lessButton.style.visibility = "visible"; moreButton.style.visibility = "hidden"; }

getValues()

}


// ====================

// DELETE BUTTON FUNCTION
function clearButton() {
 // DELETE MOTIONS' NAMES!
 Motions = document.querySelectorAll('input.voteMotion')
 for(let names of Motions) { names.value = "" }

 // DELETE ALL VOTES!
 AllVotes = document.querySelectorAll('input.votesCount')
 for(let count of AllVotes) { count.value = "0" }

 // RESET NUMBER OF MOTIONES!
 document.getElementById("howMany").value = "2"

 // SAVE DATA!
 saveData()

 // HIDING SUMMARY
 // document.getElementById("voteSummary").style.display = "none"

 // RESETTING FUNCTIONS
 initialSetup()
 getValues()
 // RESETTING THE URL
 location.replace('voting.html')
}

// ====================


function doMore() {
amount = howMany.value
var divMotion2 = document.getElementById("divMotion2")
var divMotion3 = document.getElementById("divMotion3")
var divMotion4 = document.getElementById("divMotion4")
var divMotion5 = document.getElementById("divMotion5")
if (amount >= 1 && amount <= 4) { amount++; howMany.value = amount}
initialSetup()
getValues()
}

// ====================


function doLess() {
amount = howMany.value
if (amount > 2 && amount <= 5) { amount--; howMany.value = amount }

// DELETE LAST VALUE!
var thisMotion
var maxValue = amount+1
if (maxValue >= 2 && maxValue <= 5) {
 for (let step = 1; step <= maxValue; step++) {
  thisMotion = "motion" + maxValue
  theseCount = "counts" + maxValue
  document.getElementById(thisMotion).value = ""
  document.getElementById(theseCount).value = "0"
  end = maxValue
  initialSetup()
  getValues()
  }
 } // END OF "DELETE LAST VALUE" CODE!

} // END OF "DO LESS" FUNCTION!

// ====================


// VOTING FUNCTIONALITY!
var counted1 = counts1.value
var counted2 = counts2.value
var counted3 = counts3.value
var counted4 = counts4.value
var counted5 = counts5.value
var finalCount = totalVotes.value

function vote1More() { counted1 = counts1.value; counted1++; counts1.value = counted1; moreTotal(finalCount,totalVotes); shareButton2()}
function vote1Less() { counted1=counts1.value; if(counted1 > 0 ) {counted1--; counts1.value = counted1; lessTotal(finalCount,totalVotes); shareButton2() } }

function vote2More() { counted2 = counts2.value; counted2++; counts2.value = counted2; moreTotal(finalCount,totalVotes); shareButton2() }
function vote2Less() { counted2 = counts2.value; if(counted2 > 0 ) {counted2--; counts2.value = counted2; lessTotal(finalCount,totalVotes); shareButton2() } }

function vote3More() { counted3 = counts3.value; counted3++; counts3.value = counted3; moreTotal(finalCount,totalVotes); shareButton3()}
function vote3Less() { counted3 = counts3.value; if(counted3 > 0 ) {counted3--; counts3.value = counted3; lessTotal(finalCount,totalVotes); shareButton3()} }

function vote4More() { counted4 = counts4.value; counted4++; counts4.value = counted4; moreTotal(finalCount,totalVotes); shareButton4() }
function vote4Less() { counted4 = counts4.value; if(counted4 > 0 ) {counted4--; counts4.value = counted4; lessTotal(finalCount,totalVotes); shareButton4() } }

function vote5More() { counted5 = counts5.value; counted5++; counts5.value = counted5; moreTotal(finalCount,totalVotes); shareButton5() }
function vote5Less() { counted5 = counts5.value; if(counted5 > 0 ) {counted5--; counts5.value = counted5; lessTotal(finalCount,totalVotes); shareButton5() } }

function moreTotal() { finalCount = totalVotes.value; finalCount++; totalVotes.value = finalCount; getValues() }
function lessTotal() { finalCount = totalVotes.value; finalCount--; totalVotes.value = finalCount; getValues() }

// ====================


// SETTING UP PERCENTAGE VALUES
function getValues() {

// SUM CHECK!!
var counting1 = parseInt(counts1.value)
var counting2 = parseInt(counts2.value)
var counting3 = parseInt(counts3.value)
var counting4 = parseInt(counts4.value)
var counting5 = parseInt(counts5.value)
var newSum = counting1 + counting2 + counting3 + counting4 + counting5
totalVotes.value = newSum
finalCount = newSum

// PIE CHART VALUES!!
var pie1 = Math.abs(counting1 / finalCount * 100) || 0
var pie2 = Math.abs(counting2 / finalCount * 100) || 0
var pie3 = Math.abs(counting3 / finalCount * 100) || 0
var pie4 = Math.abs(counting4 / finalCount * 100) || 0
var pie5 = Math.abs(counting5 / finalCount * 100) || 0
var pieSum = Math.abs(pie1+pie2+pie3+pie4+pie5)
var finalPercent = Math.abs(pieSum)

// CALLING OTHER FUNCTIONS
updateSummary(pie1,pie2,pie3,pie4,pie5,finalPercent)
drawCircle(pie1,pie2,pie3,pie4,pie5,finalPercent)
}

// ====================

// UPDATING "VOTE SUMMARY"
function updateSummary(pie1,pie2,pie3,pie4,pie5,finalPercent) {

// GRAPH SUMMARY
var voteSummary = document.getElementById("voteSummary")
var motion1Span = document.getElementById("motion1Span")
var motion2Span = document.getElementById("motion2Span")
var motion3Span = document.getElementById("motion3Span")
var motion4Span = document.getElementById("motion4Span")
var motion5Span = document.getElementById("motion5Span")

// CHECKING FOR EMPTY NAMES / AND ZERO VALUES BEFORE UPDATING
// EMPTY PROPOSALS WITH ZERO VOTES ARE EXCLUDED FROM THE "SUMMARY" OR "PIE CHART GRAPH"
 if (motion1.value !== "" && parseInt(counts1.value) > 0) {
  motion1Span.innerText = "- " + motion1.value.toString() + ": " + counts1.value + " (" + parseFloat(pie1).toFixed(1) + "%)."
  motion1Span.style.display = "block" } else { motion1Span.style.display = "none" }

 if (motion2.value !== "" && parseInt(counts2.value) > 0) {
  motion2Span.innerText = "- " + motion2.value.toString() + ": " + counts2.value + " (" + parseFloat(pie2).toFixed(1) + "%)."
  motion2Span.style.display = "block" } else { motion2Span.style.display = "none" }

 if (motion3.value !== "" && parseInt(counts3.value) > 0) {
  motion3Span.innerText = "- " + motion3.value.toString() + ": " + counts3.value + " (" + parseFloat(pie3).toFixed(1) + "%)."
  motion3Span.style.display = "block" } else { motion3Span.style.display = "none" }

 if (motion4.value !== "" && parseInt(counts4.value) > 0) {
  motion4Span.innerText = "- " + motion4.value.toString() + ": " + counts4.value + " (" + parseFloat(pie4).toFixed(1) + "%)."
  motion4Span.style.display = "block" } else { motion4Span.style.display = "none" }

 if (motion5.value !== "" && parseInt(counts5.value) > 0) {
  motion5Span.innerText = "- " + motion5.value.toString() + ": " + counts5.value + " (" + parseFloat(pie5).toFixed(1) + "%)."
  motion5Span.style.display = "block" } else { motion5Span.style.display = "none" }

 if (totalVotes.value !== "" || totalVotes.value !== Undefined || totalVotes.value !== NaN) {
  motionTotal.innerText = "Total: " + finalCount + " votos (" + parseInt(finalPercent) + "%)."
  motionTotal.style.display = "block"
  motionTotal.style.lineHeight = "3"
  motionTotal.style.textDecoration = "overline solid blue"
  } else { motionTotal.style.display = "none" }
  if (finalPercent !== 100) {
  motionTotal.innerText = finalCount + " votos (‚àº" + Math.round(finalPercent) + "%)."
  motionTotal.style.color = "red" } else { motionTotal.style.color = "black" }
}


// DRAW CIRCLE FUNCTION!
// DRAW CIRCLE FUNCTION!
const canvas = document.getElementById('myCanvas');
const ctx = canvas.getContext('2d');

const centerX = canvas.width / 2;
const centerY = canvas.height / 2;
const radius = 100.00;


// Function to draw the circle based on the input percentages
function drawCircle(pie1,pie2,pie3,pie4,pie5,finalPercent) {

const bluePercent = pie1
const redPercent = pie2
const orangePercent = pie3
const greenPercent = pie4
const purplePercent = pie5

// Ensure total percentage doesn't exceed 100%
var totalPercent = Math.round(bluePercent + redPercent + orangePercent + greenPercent + purplePercent)
if (totalPercent = Infinity) { totalPercent = 100.000 } // DRAWS INITIAL BORDER!
if (totalPercent !== 100.000) { return }

const blueEnd = (bluePercent / 100) * 2 * Math.PI
const redEnd = blueEnd + (redPercent / 100) * 2 * Math.PI
const orangeEnd = redEnd + (orangePercent / 100) * 2 * Math.PI
const greenEnd = orangeEnd + (greenPercent / 100) * 2 * Math.PI
const purpleEnd = greenEnd + (purplePercent / 100) * 2 * Math.PI

// Clear previous circle
ctx.clearRect(0, 0, canvas.width, canvas.height);

// Draw the blue arc
ctx.beginPath();
ctx.moveTo(centerX, centerY);
ctx.arc(centerX, centerY, radius, 0, blueEnd);
ctx.closePath();
ctx.fillStyle = 'cornflowerblue';
ctx.fill();

// Draw the red arc
ctx.beginPath();
ctx.moveTo(centerX, centerY);
ctx.arc(centerX, centerY, radius, blueEnd, redEnd);
ctx.closePath();
ctx.fillStyle = '#DD0000';
ctx.fill();

// Draw the orange arc
ctx.beginPath();
ctx.moveTo(centerX, centerY);
ctx.arc(centerX, centerY, radius, redEnd, orangeEnd);
ctx.closePath();
ctx.fillStyle = 'orange';
ctx.fill();

// Draw the green arc
ctx.beginPath();
ctx.moveTo(centerX, centerY);
ctx.arc(centerX, centerY, radius, orangeEnd, greenEnd);
ctx.closePath();
ctx.fillStyle = 'green';
ctx.fill();

// Draw the purple arc
ctx.beginPath();
ctx.moveTo(centerX, centerY);
ctx.arc(centerX, centerY, radius, greenEnd, purpleEnd);
ctx.closePath();
ctx.fillStyle = 'purple';
ctx.fill();

// BORDER
ctx.beginPath();
ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
ctx.strokeStyle = "#000000cc";
ctx.lineWidth = 2;
ctx.stroke();


// TEXT PARAMETERS
ctx.zindex=1;
ctx.fillStyle = 'blue';
ctx.font = 'normal 12px Tahoma';

if (pie1 > pie2) { // RESULTS FOR MOTION 1!
 ctx.fillText(motion1.value, centerX + 15, centerY + 15);
 ctx.font = 'italic 10px Arial';
 ctx.fillText('('+pie1.toFixed(1)+'%)', centerX + 15, centerY + 25); }

if (pie1 < pie2) { // RESULTS FOR MOTION 2!
 ctx.fillStyle = 'white';
 ctx.fillText(motion2.value, centerX - 90, centerY);
 ctx.font = 'italic 10px Arial';
 ctx.fillText('('+pie2.toFixed(1)+'%)', centerX - 90, centerY + 10); }

// TEXT AROUND THE ARC!
function drawTextAlongArc(ctx, str, centerX, centerY, radius, angle){
	ctx.save();
	ctx.translate(centerX + 4, centerY - 4);
	ctx.rotate(-2 * angle / 18);
	ctx.rotate(-1 * (angle / str.length) / 1);
	for (var n = 0; n < str.length; n++) {
	ctx.rotate(angle / str.length);
	ctx.save();
	ctx.translate(12, -1 * radius);
	var char = str[n];
	ctx.fillText(char, 0, 0);
	ctx.restore();
	}
  ctx.restore();
}

var sumVars = (pie2 + pie3 + pie4 + pie5).toFixed(1)
var theVars = 'Otras propuestas: '+ sumVars + '%'
var angle = Math.PI * 0.5; // radians
ctx.font = 'italic 9px Verdana';

drawTextAlongArc(ctx, theVars, centerX, centerY, radius, angle);
}

// Initial draw
// drawCircle();

// ====================
// SHARE BUTTON FUNCTIONS

function shareButton2() {
 if (motion1.value.trim() !== '' && motion2.value.trim() !== '') { shareButton.style.display = "block" }
 else { shareButton.style.display = "none" }
}

function shareButton3() {
 if (motion1.value.trim() !== '' && motion2.value.trim() !== '' && motion3.value.trim() !== '') { shareButton.style.display = "block" }
 else { shareButton.style.display = "none" }
}

function shareButton4() {
 if (motion1.value.trim() !== '' && motion2.value.trim() !== '' && motion3.value.trim() !== '' && motion4.value.trim() !== '') { shareButton.style.display = "block" }
 else { shareButton.style.display = "none" }
}

function shareButton5() {
 if (motion1.value.trim() !== '' && motion2.value.trim() !== '' && motion3.value.trim() !== '' && motion4.value.trim() !== '' && motion5.value.trim() !== '') { shareButton.style.display = "block" }
 else { shareButton.style.display = "none" }
}

// END OF MAIN SCRIPT
</script>




<!- SAVE FUNCTION ->
<script type="text/javascript">
window.onbeforeunload = function() {
if (typeof(Storage) !== "undefined") { saveData() }
}

function saveData() {
localStorage.howMany = document.getElementById("howMany").value
localStorage.motion1 = document.getElementById("motion1").value; localStorage.counts1 = document.getElementById("counts1").value
localStorage.motion2 = document.getElementById("motion2").value; localStorage.counts2 = document.getElementById("counts2").value
localStorage.motion3 = document.getElementById("motion3").value; localStorage.counts3 = document.getElementById("counts3").value
localStorage.motion4 = document.getElementById("motion4").value; localStorage.counts4 = document.getElementById("counts4").value
localStorage.motion5 = document.getElementById("motion5").value; localStorage.counts5 = document.getElementById("counts5").value
}

window.onload = function() {
// LOAD DATA!
loadData()
// CALLS TO ANOTHER FUNCTION!!
initialSetup()
getLinkValues()
}

function loadData() {
document.getElementById("howMany").value = localStorage.howMany || "1"
document.getElementById("motion1").value = localStorage.motion1 || ""; document.getElementById("counts1").value = localStorage.counts1 || "0"
document.getElementById("motion2").value = localStorage.motion2 || ""; document.getElementById("counts2").value = localStorage.counts2 || "0"
document.getElementById("motion3").value = localStorage.motion3 || ""; document.getElementById("counts3").value = localStorage.counts3 || "0"
document.getElementById("motion4").value = localStorage.motion4 || ""; document.getElementById("counts4").value = localStorage.counts4 || "0"
document.getElementById("motion5").value = localStorage.motion5 || ""; document.getElementById("counts5").value = localStorage.counts5 || "0"
}
</script>




<script type="text/javascript">
// DECLARING URL LINK ELEMENTS
var urlAmount = (new URLSearchParams(window.location.search)).get("cv")
var url1Motion = (new URLSearchParams(window.location.search)).get("m1")
var url1Amount = (new URLSearchParams(window.location.search)).get("v1")
var url2Motion = (new URLSearchParams(window.location.search)).get("m2")
var url2Amount = (new URLSearchParams(window.location.search)).get("v2")
var url3Motion = (new URLSearchParams(window.location.search)).get("m3")
var url3Amount = (new URLSearchParams(window.location.search)).get("v3")
var url4Motion = (new URLSearchParams(window.location.search)).get("m4")
var url4Amount = (new URLSearchParams(window.location.search)).get("v4")
var url5Motion = (new URLSearchParams(window.location.search)).get("m5")
var url5Amount = (new URLSearchParams(window.location.search)).get("v5")

// DECLARING VOTING ELEMENTS
var howMany = document.getElementById('howMany')
var motion1 = document.getElementById('motion1')
var counts1 = document.getElementById('counts1')
var motion2 = document.getElementById('motion2')
var counts2 = document.getElementById('counts2')
var motion3 = document.getElementById('motion3')
var counts4 = document.getElementById('counts3')
var motion4 = document.getElementById('motion4')
var counts4 = document.getElementById('counts4')
var motion5 = document.getElementById('motion5')
var counts5 = document.getElementById('counts5')


function getLinkValues() {
if (urlAmount >= 2 && urlAmount <= 5) {howMany.value = urlAmount; initialSetup() }
if (url1Motion !== null) {motion1.value = url1Motion; initialSetup() }
if (url1Amount !== null) {counts1.value = url1Amount; initialSetup() }
if (url2Motion !== null) {motion2.value = url2Motion; initialSetup() }
if (url2Amount !== null) {counts2.value = url2Amount; initialSetup() }
if (url3Motion !== null) {motion3.value = url3Motion; initialSetup() }
if (url3Amount !== null) {counts3.value = url3Amount; initialSetup() }
if (url4Motion !== null) {motion4.value = url4Motion; initialSetup() }
if (url4Amount !== null) {counts4.value = url4Amount; initialSetup() }
if (url5Motion !== null) {motion5.value = url5Motion; initialSetup() }
if (url5Amount !== null) {counts5.value = url5Amount; initialSetup() }

// /=================================================================================================\
// | Format: /voting.html?cv=4&m1=Paro&v1=31&m2=No%20Paro&v2=2&m3=Abstencion&v3=1&m4=Sin%20Voto&v4=1 |
// \=================================================================================================/

}


// ====================
/*
// CHECKING FOR EMPTY SPACES IN LINK...
// ENDED UP USING ONLY 1 LINE BELOW!
function checkSpaces() {
if (input.value.includes(' ')) {
 console.log("Input has blank space!\nReplacing empty spaces!")
 input.value = input.value.replaceAll(' ', '%20');
 console.log(input.value)
 }
}
*/
// ====================


function shareLink() {
 var shareButton = document.getElementById("shareButton")
 var thisURL = "https://uplanianos.github.io/app/voting.html++++++"
 var trunURL = thisURL.substr(0, 44);
 var theVotes = ""
 if (howMany.value == 2) {
	theVotes =
	"?cv=" + howMany.value +
	"&m1=" + motion1.value.replaceAll(' ', '%20') +
	"&v1=" + counts1.value +
	"&m2=" + motion2.value.replaceAll(' ', '%20') +
	"&v2=" + counts2.value;
 }
 if (howMany.value == 3) {
	theVotes =
	"?cv=" + howMany.value +
	"&m1=" + motion1.value.replaceAll(' ', '%20') +
	"&v1=" + counts1.value +
	"&m2=" + motion2.value.replaceAll(' ', '%20') +
	"&v2=" + counts2.value +
	"&m3=" + motion3.value.replaceAll(' ', '%20') +
	"&v3=" + counts3.value;
 }
 if (howMany.value == 4) {
	theVotes =
	"?cv=" + howMany.value +
	"&m1=" + motion1.value.replaceAll(' ', '%20') +
	"&v1=" + counts1.value +
	"&m2=" + motion2.value.replaceAll(' ', '%20') +
	"&v2=" + counts2.value +
	"&m3=" + motion3.value.replaceAll(' ', '%20') +
	"&v3=" + counts3.value +
	"&m4=" + motion4.value.replaceAll(' ', '%20') +
	"&v4=" + counts4.value;
 }
 if (howMany.value == 5) {
	theVotes =
	"?cv=" + howMany.value +
	"&m1=" + motion1.value.replaceAll(' ', '%20') +
	"&v1=" + counts1.value +
	"&m2=" + motion2.value.replaceAll(' ', '%20') +
	"&v2=" + counts2.value +
	"&m3=" + motion3.value.replaceAll(' ', '%20') +
	"&v3=" + counts3.value +
	"&m4=" + motion4.value.replaceAll(' ', '%20') +
	"&v4=" + counts4.value +
	"&m5=" + motion5.value.replaceAll(' ', '%20') +
	"&v5=" + counts5.value;
 }
 // COPYING GENERATED LINK!
 navigator.clipboard.writeText(trunURL+theVotes)
 // UPDATING BUTTON
 shareButton.innerHTML = "COPIANDO üó≥Ô∏è !"
 shareButton.style.backgroundColor = "green"
 // UPDATING LINK DYNAMIC WARNING!
 setTimeout(function() { shareButton.innerHTML = "ABRIENDO..."; shareButton.style.backgroundColor = "red" }, 2500)
 setTimeout(function() { shareButton.innerHTML = "NUEVO..." }, 3000)
 setTimeout(function() { shareButton.innerHTML = "LINK..." }, 3500)
 setTimeout(function() { shareButton.innerHTML = "AHORA YA!"; shareButton.style.color = "yellow"; shareButton.style.fontWeight = "bold" }, 4000)
 // REDIRECTION TO NEW URL!
 setTimeout(function() { location.replace(trunURL+theVotes) }, 4500)
}
</script>



<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
var currentScrollPos = window.pageYOffset;
  if (prevScrollpos > currentScrollPos) {
    document.getElementById("return").style.top = "6px"; 
  } else {
    document.getElementById("return").style.top = "-40px"; 
  }
  prevScrollpos = currentScrollPos;
}
</script>


</body>
</html>

